<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Gerador de Crachá - Seminário Linux Embarcado 2025 - Online</title>

<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Arial, sans-serif; }
  body {
    background: linear-gradient(135deg, #1a2a3a 0%, #0d1721 100%);
    min-height: 100vh; display:flex; flex-direction:column; align-items:center; padding:20px; color:#fff;
  }
  header { text-align:center; margin-bottom:30px; width:100%; }
  h1 { color:#4CAF50; margin-bottom:10px; font-size:2.2rem; text-shadow:0 0 10px rgba(76,175,80,.5); }
  .subtitle { color:#ccc; font-size:1.1rem; }
  .container { display:flex; flex-wrap:wrap; justify-content:center; gap:30px; max-width:1200px; width:100%; }
  .form-container {
    background:rgba(255,255,255,.1); padding:25px; border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,.3); width:100%; max-width:400px; backdrop-filter:blur(10px);
  }
  .form-title { color:#4CAF50; margin-bottom:20px; text-align:center; font-size:1.6rem; }
  .form-group { margin-bottom:20px; }
  label { display:block; margin-bottom:8px; color:#ccc; font-weight:500; }
  input {
    width:100%; padding:12px 15px; border:2px solid #444; border-radius:8px; font-size:16px;
    transition:border-color .3s; background:rgba(255,255,255,.9);
  }
  input:focus { border-color:#4CAF50; outline:none; }
  button {
    background:#4CAF50; color:#fff; border:none; padding:14px 20px; border-radius:8px;
    font-size:16px; cursor:pointer; width:100%; font-weight:600; transition:background .3s; margin-top:10px;
  }
  button:hover { background:#3d8b40; transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,0,0,.2); }
  .badge-container { display:flex; flex-direction:column; align-items:center; width:100%; max-width:400px; }
  .badge-preview {
    width:100%; text-align:center; margin-bottom:20px; border-radius:15px; overflow:hidden;
    box-shadow:0 10px 30px rgba(0,0,0,.4);
  }
  .badge {
    width:100%; padding-bottom:140%; color:white; position:relative;
    background-size:contain; background-position:center; background-repeat:no-repeat;
  }
  .badge-content { position:absolute; inset:0; display:flex; flex-direction:column; justify-content:center; }
  .badge-name, .badge-company {
    position:absolute; color:#000; text-align:center; width:80%; left:10%; text-transform:uppercase; line-height:1.2;
    word-break:break-word;
  }
  .badge-name { top:60%; font-weight:bold; font-size:5vw; }
  .badge-company { top:68%; font-weight:500; font-size:4vw; text-transform:uppercase; }
  .download-btn { background:#FFC107; color:#333; margin-top:15px; }
  .download-btn:hover { background:#e6ac0c; }
  .instructions {
    margin-top:30px; background:rgba(255,255,255,.1); padding:20px; border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,.3); max-width:800px; width:100%; backdrop-filter:blur(10px);
  }
  .instructions h2 { color:#4CAF50; margin-bottom:15px; text-align:center; font-size:1.5rem; }
  .instructions ol { padding-left:20px; color:#ccc; }
  .instructions li { margin-bottom:10px; line-height:1.5; }

  @media (min-width:768px){
    h1{font-size:2.5rem;} .subtitle{font-size:1.2rem;}
    .badge-name{font-size:26px;} .badge-company{font-size:20px;}
  }
  @media (max-width:480px){
    body{padding:15px;} header{margin-bottom:20px;} h1{font-size:1.8rem;}
    .container{gap:20px;} .form-container{padding:20px;}
    .badge-name{font-size:18px; top:56%;} .badge-company{font-size:16px; top:66%;}
    .instructions{padding:15px;}
  }

  footer {
  margin-top: 40px;
  padding: 20px;
  text-align: center;
  color: #ccc;
  font-size: 0.9rem;
  border-top: 1px solid rgba(255,255,255,0.1);
}

footer a {
  color: #4CAF50;
  text-decoration: none;
  font-weight: 500;
}

footer a:hover {
  text-decoration: underline;
}

footer .credit {
  margin-top: 8px;
  font-size: 0.85rem;
  color: #aaa;
  font-style: italic;
}

  /* Esconde a imagem do template usada para medir tamanho real */
  #templateImg { display:none; }
</style>
</head>
<body>
  <header>
    <h1>Gerador de Crachá</h1>
    <p class="subtitle">Seminário Linux Embarcado 2025 - Online - 30 de Agosto</p>
  </header>

  <div class="container">
    <div class="form-container">
      <h2 class="form-title">Preencha seus dados</h2>
      <form id="badgeForm">
        <div class="form-group">
          <label for="firstName">Nome</label>
          <input type="text" id="firstName" placeholder="Seu nome" required />
        </div>
        <div class="form-group">
          <label for="lastName">Sobrenome</label>
          <input type="text" id="lastName" placeholder="Seu sobrenome" required />
        </div>
        <div class="form-group">
          <label for="company">Empresa</label>
          <input type="text" id="company" placeholder="Sua empresa" required />
        </div>
      </form>
    </div>

    <div class="badge-container">
      <h2 class="form-title">Visualização do Crachá</h2>
      <div class="badge-preview">
        <div class="badge" id="badge">
          <div class="badge-content">
            <div class="badge-name" id="previewName">Nome Completo</div>
            <div class="badge-company" id="previewCompany">Empresa</div>
          </div>
        </div>
      </div>

      <!-- Opcional: permitir exportar em 2x (para redes sociais/print melhor) -->
      <button class="download-btn" id="downloadBtn" disabled>Baixar Crachá (PNG)</button>
      <small style="opacity:.8; margin-top:8px;">
        Gere seu crachá virtual e compartilhe nas redes sociais mostrando que você está participando deste grande evento
      </small>
    </div>
  </div>

  <div class="instructions">
    <h2>Como usar</h2>
    <ol>
      <li>Preencha o formulário com seu nome, sobrenome e empresa.</li>
      <li>Clique em “Baixar Crachá” para salvar o PNG em alta resolução.</li>
    </ol>
  </div>

  <!-- Template em alta resolução (mesma pasta). Ative CORS no host se servir por CDN. -->
  <img id="templateImg" src="Crachá.png" alt="Template do Crachá" crossorigin="anonymous"/>

<script>
(function(){
  const firstNameInput  = document.getElementById('firstName');
  const lastNameInput   = document.getElementById('lastName');
  const companyInput    = document.getElementById('company');
  const previewName     = document.getElementById('previewName');
  const previewCompany  = document.getElementById('previewCompany');
  const badgeElement    = document.getElementById('badge');
  const downloadBtn     = document.getElementById('downloadBtn');
  const templateImg     = document.getElementById('templateImg');

  function updatePreview(){
    const first = firstNameInput.value.trim();
    const last  = lastNameInput.value.trim();
    const comp  = companyInput.value.trim();

    previewName.textContent    = (first || last) ? `${first} ${last}`.trim() : 'Nome Completo';
    previewCompany.textContent = comp || 'Empresa';

    // habilita botão se tudo preenchido
    downloadBtn.disabled = !(first && last && comp);
  }

  function setupPreviewBackground(){
    const src = templateImg.getAttribute('src');
    badgeElement.style.backgroundImage = `url('${src}')`;
    if (templateImg.naturalWidth && templateImg.naturalHeight) {
      const aspectPercent = (templateImg.naturalHeight / templateImg.naturalWidth) * 100;
      badgeElement.style.paddingBottom = aspectPercent + '%';
    }
  }

  function drawWrappedText(ctx, text, x, y, maxWidth, lineHeight){
    const words = text.split(' ');
    let line = '';
    const lines = [];
    for (let n = 0; n < words.length; n++) {
      const testLine = (line ? line + ' ' : '') + words[n];
      const metrics = ctx.measureText(testLine);
      if (metrics.width > maxWidth && n > 0) {
        lines.push(line);
        line = words[n];
      } else {
        line = testLine;
      }
    }
    lines.push(line);
    let offsetY = 0;
    if (lines.length > 1) offsetY = -((lines.length - 1) * lineHeight) / 2;
    lines.forEach((ln, i) => ctx.fillText(ln, x, y + offsetY + i*lineHeight));
  }

  async function downloadBadge(){
    downloadBtn.textContent = 'Processando...';
    downloadBtn.disabled = true;

    try {
      if (!templateImg.complete || templateImg.naturalWidth === 0) {
        await new Promise((resolve, reject) => {
          templateImg.onload = resolve;
          templateImg.onerror = () => reject(new Error("Falha ao carregar 'Crachá.png'"));
        });
      }

      const w = templateImg.naturalWidth;
      const h = templateImg.naturalHeight;

      const canvas = document.createElement('canvas');
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext('2d');

      ctx.drawImage(templateImg, 0, 0, w, h);

      // TEXTOS (uppercase para manter consistência com o preview)
      const nameText = (`${firstNameInput.value.trim()} ${lastNameInput.value.trim()}`).trim().toUpperCase();
      const compText = (companyInput.value.trim()).toUpperCase();

      const centerX = w * 0.5;
      const usableWidth = w * 0.80;

      // Ajuste fino da posição (altere as frações conforme sua arte)
      const nameY = h * 0.63;  // ↓ deixe maior para descer o nome (ex: 0.63)
      const compY = h * 0.73;  // ↓ idem para empresa se desejar acompanhar

      const nameFontSize = Math.round(w * 0.060);
      const compFontSize = Math.round(w * 0.045);

      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillStyle = '#000';

      ctx.font = `bold ${nameFontSize}px "Segoe UI", Arial, sans-serif`;
      drawWrappedText(ctx, nameText || 'NOME COMPLETO', centerX, nameY, usableWidth, Math.round(nameFontSize * 1.15));

      ctx.font = `500 ${compFontSize}px "Segoe UI", Arial, sans-serif`;
      drawWrappedText(ctx, compText || 'EMPRESA', centerX, compY, usableWidth, Math.round(compFontSize * 1.15));

      const link = document.createElement('a');
      link.download = 'cracha-seminario-linux.png';
      link.href = canvas.toDataURL('image/png');
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);

    } catch (err) {
      console.error(err);
      alert('Erro ao gerar a imagem. Verifique se "Crachá.png" está acessível (CORS/mesmo domínio).');
    } finally {
      downloadBtn.textContent = 'Baixar Crachá (PNG)';
      downloadBtn.disabled = false;
    }
  }

  firstNameInput.addEventListener('input', updatePreview);
  lastNameInput.addEventListener('input', updatePreview);
  companyInput.addEventListener('input', updatePreview);
  downloadBtn.addEventListener('click', downloadBadge);

  templateImg.addEventListener('load', setupPreviewBackground);
  templateImg.addEventListener('error', () => {
    alert("Erro: Não foi possível carregar a imagem 'Crachá.png'. Verifique se o arquivo está na mesma pasta e se o servidor habilita CORS.");
    badgeElement.style.backgroundImage = "none";
    badgeElement.style.backgroundColor = "#0d1721";
  });

  if (templateImg.complete) setupPreviewBackground();
  updatePreview();
})();
</script>


<footer>
  <p>© 2025 Seminário Linux Embarcado — Embarcados</p>
  <p>
    <a href="https://embarcados.com.br/seminario-linux-embarcado-2025/" target="_blank">Site Oficial</a>
  </p>
  <p class="credit">Desenvolvido por Fábio Souza</p>
</footer>


</body>

</html>
